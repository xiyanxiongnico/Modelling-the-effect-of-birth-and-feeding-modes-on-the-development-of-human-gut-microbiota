# to access break formatting functions
library(scales)
library(ggplot2)
load("dynamics_competition_vaginal.rdata")
dynamics_competition_vaginal <- ggplot(data = bacteria_melt, aes(x = time, y = value,
color = variable)) +
geom_line(size = 0.8, aes(linetype=variable)) +
scale_linetype_manual(values=c("twodash", "solid", "dashed"),
labels=c(expression(B[1]), expression(B[2]),expression(B[3]))) +
scale_color_manual(values = c("skyblue2","seagreen3","violetred2"),
labels=c(expression(B[1]), expression(B[2]),expression(B[3]))) +
scale_y_log10(breaks = trans_breaks("log10", function(x) 10^x),
labels = trans_format("log10", math_format(10^.x)),limits = c(5e-4,1.5)) +
mytheme +
labs( x = "Time (days)", y = "Population density",
title = "Vaginal") +
annotate("text", x = 500, y = 0.005, label = "HMO-consuming Bifidobacteria B1",
color = "skyblue2", size = 2.8) +
annotate("text", x = 500, y = 0.5, label = "Fibre-consuming Bifidobacteria B2",
color = "seagreen3", size = 2.8) +
annotate("text", x = 700, y = 0.03, label = "Commensal competitor B3",color = "violetred2",
size = 2.8)
show(dynamics_competition_vaginal)
load("dynamics_competition_c-section.rdata")
dynamics_competition_c_section <- ggplot(data = bacteria_melt, aes(x = time, y = value,
color = variable)) +
geom_line(size = 0.8, aes(linetype=variable)) +
scale_linetype_manual(values=c("twodash", "solid","dashed"),
labels=c(expression(B[1]), expression(B[2]),expression(B[3]))) +
scale_color_manual(values = c("skyblue2","seagreen3","violetred2"),
labels=c(expression(B[1]), expression(B[2]),expression(B[3]))) +
scale_y_log10(breaks = trans_breaks("log10", function(x) 10^x),
labels = trans_format("log10", math_format(10^.x)),limits = c(5e-4,1.5)) +
mytheme +
labs( x = "Time (days)", y = "Population density",
title = "Caesarean") +
annotate("text", x = 500, y = 0.005, label = "HMO-consuming Bifidobacteria B1",
color = "skyblue2", size = 2.8) +
annotate("text", x = 500, y = 0.05, label = "Fibre-consuming Bifidobacteria B2",
color = "seagreen3", size = 2.8) +
annotate("text", x = 500, y = 0.5, label = "Commensal competitor B3",color = "violetred2",
size = 2.8)
show(dynamics_competition_c_section)
library(ggpubr)
dynamics_competition <- ggarrange(dynamics_competition_vaginal, dynamics_competition_c_section,
labels = c("A", "B"), nrow = 1, ncol = 2)
show(dynamics_competition)
ggsave(file = output_dynamics, width = 17, height = 8.5, units = "cm")
setwd("~/Documents/GitHub/Modelling-the-effect-of-birth-and-feeding-modes-on-the-development-of-human-gut-microbiota/code/data generation")
source('~/Documents/GitHub/Modelling-the-effect-of-birth-and-feeding-modes-on-the-development-of-human-gut-microbiota/code/data generation/dynamics of competition model.R')
output_dynamics <- "plots/dynamics_competition.pdf"
# set my theme
mytheme <- theme_bw() +
theme(panel.grid.minor =  element_blank(),
plot.title = element_text(size = 15),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14),
legend.position = "none")
library(tidyr)
# to access break formatting functions
library(scales)
library(ggplot2)
load("dynamics_competition_vaginal.rdata")
dynamics_competition_vaginal <- ggplot(data = bacteria_melt, aes(x = time, y = value,
color = variable)) +
geom_line(size = 0.8, aes(linetype=variable)) +
scale_linetype_manual(values=c("twodash", "solid", "dashed"),
labels=c(expression(B[1]), expression(B[2]),expression(B[3]))) +
scale_color_manual(values = c("skyblue2","seagreen3","violetred2"),
labels=c(expression(B[1]), expression(B[2]),expression(B[3]))) +
scale_y_log10(breaks = trans_breaks("log10", function(x) 10^x),
labels = trans_format("log10", math_format(10^.x)),limits = c(5e-4,1.5)) +
mytheme +
labs( x = "Time (days)", y = "Population density",
title = "Vaginal") +
annotate("text", x = 500, y = 0.005, label = "HMO-consuming Bifidobacteria B1",
color = "skyblue2", size = 2.8) +
annotate("text", x = 500, y = 0.5, label = "Fibre-consuming Bifidobacteria B2",
color = "seagreen3", size = 2.8) +
annotate("text", x = 700, y = 0.03, label = "Commensal competitor B3",color = "violetred2",
size = 2.8)
show(dynamics_competition_vaginal)
load("dynamics_competition_c-section.rdata")
dynamics_competition_c_section <- ggplot(data = bacteria_melt, aes(x = time, y = value,
color = variable)) +
geom_line(size = 0.8, aes(linetype=variable)) +
scale_linetype_manual(values=c("twodash", "solid","dashed"),
labels=c(expression(B[1]), expression(B[2]),expression(B[3]))) +
scale_color_manual(values = c("skyblue2","seagreen3","violetred2"),
labels=c(expression(B[1]), expression(B[2]),expression(B[3]))) +
scale_y_log10(breaks = trans_breaks("log10", function(x) 10^x),
labels = trans_format("log10", math_format(10^.x)),limits = c(5e-4,1.5)) +
mytheme +
labs( x = "Time (days)", y = "Population density",
title = "Caesarean") +
annotate("text", x = 500, y = 0.005, label = "HMO-consuming Bifidobacteria B1",
color = "skyblue2", size = 2.8) +
annotate("text", x = 500, y = 0.05, label = "Fibre-consuming Bifidobacteria B2",
color = "seagreen3", size = 2.8) +
annotate("text", x = 500, y = 0.5, label = "Commensal competitor B3",color = "violetred2",
size = 2.8)
show(dynamics_competition_c_section)
library(ggpubr)
dynamics_competition <- ggarrange(dynamics_competition_vaginal, dynamics_competition_c_section,
labels = c("A", "B"), nrow = 1, ncol = 2)
show(dynamics_competition)
ggsave(file = output_dynamics, width = 17, height = 8.5, units = "cm")
# set my theme
mytheme <- theme_bw() +
theme(panel.grid.minor =  element_blank(),
plot.title = element_text(size = 15),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14),
legend.position = "none")
library(tidyr)
# to access break formatting functions
library(scales)
library(ggplot2)
# load data
load("../data generation/data/dynamics_competition_vaginal.rData")
dynamics_competition_vaginal <- ggplot(data = bacteria_melt, aes(x = time, y = value,
color = variable)) +
geom_line(size = 0.8, aes(linetype=variable)) +
scale_linetype_manual(values=c("twodash", "solid", "dashed"),
labels=c(expression(B[1]), expression(B[2]),expression(B[3]))) +
scale_color_manual(values = c("skyblue2","seagreen3","violetred2"),
labels=c(expression(B[1]), expression(B[2]),expression(B[3]))) +
scale_y_log10(breaks = trans_breaks("log10", function(x) 10^x),
labels = trans_format("log10", math_format(10^.x)),limits = c(5e-4,1.5)) +
mytheme +
labs( x = "Time (days)", y = "Population density",
title = "Vaginal") +
annotate("text", x = 500, y = 0.005, label = "HMO-consuming Bifidobacteria B1",
color = "skyblue2", size = 2.8) +
annotate("text", x = 500, y = 0.5, label = "Fibre-consuming Bifidobacteria B2",
color = "seagreen3", size = 2.8) +
annotate("text", x = 700, y = 0.03, label = "Commensal competitor B3",color = "violetred2",
size = 2.8)
show(dynamics_competition_vaginal)
# load data
load("../data generation/data/dynamics_competition_c-section.rData")
dynamics_competition_c_section <- ggplot(data = bacteria_melt, aes(x = time, y = value,
color = variable)) +
geom_line(size = 0.8, aes(linetype=variable)) +
scale_linetype_manual(values=c("twodash", "solid","dashed"),
labels=c(expression(B[1]), expression(B[2]),expression(B[3]))) +
scale_color_manual(values = c("skyblue2","seagreen3","violetred2"),
labels=c(expression(B[1]), expression(B[2]),expression(B[3]))) +
scale_y_log10(breaks = trans_breaks("log10", function(x) 10^x),
labels = trans_format("log10", math_format(10^.x)),limits = c(5e-4,1.5)) +
mytheme +
labs( x = "Time (days)", y = "Population density",
title = "Caesarean") +
annotate("text", x = 500, y = 0.005, label = "HMO-consuming Bifidobacteria B1",
color = "skyblue2", size = 2.8) +
annotate("text", x = 500, y = 0.05, label = "Fibre-consuming Bifidobacteria B2",
color = "seagreen3", size = 2.8) +
annotate("text", x = 500, y = 0.5, label = "Commensal competitor B3",color = "violetred2",
size = 2.8)
show(dynamics_competition_c_section)
library(ggpubr)
dynamics_competition <- ggarrange(dynamics_competition_vaginal, dynamics_competition_c_section,
labels = c("A", "B"), nrow = 1, ncol = 2)
show(dynamics_competition)
ggsave(file = output_dynamics, width = 17, height = 8.5, units = "cm")
setwd("~/Documents/GitHub/Modelling-the-effect-of-birth-and-feeding-modes-on-the-development-of-human-gut-microbiota/code/plot generation")
# set my theme
mytheme <- theme_bw() +
theme(panel.grid.minor =  element_blank(),
plot.title = element_text(size = 15),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14),
legend.position = "none")
library(tidyr)
# to access break formatting functions
library(scales)
library(ggplot2)
# load data
load("../data generation/data/dynamics_competition_vaginal.rData")
dynamics_competition_vaginal <- ggplot(data = bacteria_melt, aes(x = time, y = value,
color = variable)) +
geom_line(size = 0.8, aes(linetype=variable)) +
scale_linetype_manual(values=c("twodash", "solid", "dashed"),
labels=c(expression(B[1]), expression(B[2]),expression(B[3]))) +
scale_color_manual(values = c("skyblue2","seagreen3","violetred2"),
labels=c(expression(B[1]), expression(B[2]),expression(B[3]))) +
scale_y_log10(breaks = trans_breaks("log10", function(x) 10^x),
labels = trans_format("log10", math_format(10^.x)),limits = c(5e-4,1.5)) +
mytheme +
labs( x = "Time (days)", y = "Population density",
title = "Vaginal") +
annotate("text", x = 500, y = 0.005, label = "HMO-consuming Bifidobacteria B1",
color = "skyblue2", size = 2.8) +
annotate("text", x = 500, y = 0.5, label = "Fibre-consuming Bifidobacteria B2",
color = "seagreen3", size = 2.8) +
annotate("text", x = 700, y = 0.03, label = "Commensal competitor B3",color = "violetred2",
size = 2.8)
show(dynamics_competition_vaginal)
# load data
load("../data generation/data/dynamics_competition_c-section.rData")
dynamics_competition_c_section <- ggplot(data = bacteria_melt, aes(x = time, y = value,
color = variable)) +
geom_line(size = 0.8, aes(linetype=variable)) +
scale_linetype_manual(values=c("twodash", "solid","dashed"),
labels=c(expression(B[1]), expression(B[2]),expression(B[3]))) +
scale_color_manual(values = c("skyblue2","seagreen3","violetred2"),
labels=c(expression(B[1]), expression(B[2]),expression(B[3]))) +
scale_y_log10(breaks = trans_breaks("log10", function(x) 10^x),
labels = trans_format("log10", math_format(10^.x)),limits = c(5e-4,1.5)) +
mytheme +
labs( x = "Time (days)", y = "Population density",
title = "Caesarean") +
annotate("text", x = 500, y = 0.005, label = "HMO-consuming Bifidobacteria B1",
color = "skyblue2", size = 2.8) +
annotate("text", x = 500, y = 0.05, label = "Fibre-consuming Bifidobacteria B2",
color = "seagreen3", size = 2.8) +
annotate("text", x = 500, y = 0.5, label = "Commensal competitor B3",color = "violetred2",
size = 2.8)
show(dynamics_competition_c_section)
library(ggpubr)
dynamics_competition <- ggarrange(dynamics_competition_vaginal, dynamics_competition_c_section,
labels = c("A", "B"), nrow = 1, ncol = 2)
show(dynamics_competition)
ggsave(file = output_dynamics, width = 17, height = 8.5, units = "cm")
# load data
load("../data generation/data/dynamics_competition_vaginal.rData")
# load data
load("../data generation/data/dynamics_competition_c-section.rData")
# set my theme
mytheme <- theme_bw() +
theme(panel.grid.minor =  element_blank(),
plot.title = element_text(size = 15),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14),
legend.position = "none")
library(tidyr)
# to access break formatting functions
library(scales)
library(ggplot2)
# load data
load("../data generation/data/dynamics_competition_vaginal.rData")
dynamics_competition_vaginal <- ggplot(data = bacteria_melt, aes(x = time, y = value,
color = variable)) +
geom_line(size = 0.8, aes(linetype=variable)) +
scale_linetype_manual(values=c("twodash", "solid", "dashed"),
labels=c(expression(B[1]), expression(B[2]),expression(B[3]))) +
scale_color_manual(values = c("skyblue2","seagreen3","violetred2"),
labels=c(expression(B[1]), expression(B[2]),expression(B[3]))) +
scale_y_log10(breaks = trans_breaks("log10", function(x) 10^x),
labels = trans_format("log10", math_format(10^.x)),limits = c(5e-4,1.5)) +
mytheme +
labs( x = "Time (days)", y = "Population density",
title = "Vaginal") +
annotate("text", x = 500, y = 0.005, label = "HMO-consuming Bifidobacteria B1",
color = "skyblue2", size = 2.8) +
annotate("text", x = 500, y = 0.5, label = "Fibre-consuming Bifidobacteria B2",
color = "seagreen3", size = 2.8) +
annotate("text", x = 700, y = 0.03, label = "Commensal competitor B3",color = "violetred2",
size = 2.8)
show(dynamics_competition_vaginal)
# load data
load("../data generation/data/dynamics_competition_c-section.rData")
dynamics_competition_c_section <- ggplot(data = bacteria_melt, aes(x = time, y = value,
color = variable)) +
geom_line(size = 0.8, aes(linetype=variable)) +
scale_linetype_manual(values=c("twodash", "solid","dashed"),
labels=c(expression(B[1]), expression(B[2]),expression(B[3]))) +
scale_color_manual(values = c("skyblue2","seagreen3","violetred2"),
labels=c(expression(B[1]), expression(B[2]),expression(B[3]))) +
scale_y_log10(breaks = trans_breaks("log10", function(x) 10^x),
labels = trans_format("log10", math_format(10^.x)),limits = c(5e-4,1.5)) +
mytheme +
labs( x = "Time (days)", y = "Population density",
title = "Caesarean") +
annotate("text", x = 500, y = 0.005, label = "HMO-consuming Bifidobacteria B1",
color = "skyblue2", size = 2.8) +
annotate("text", x = 500, y = 0.05, label = "Fibre-consuming Bifidobacteria B2",
color = "seagreen3", size = 2.8) +
annotate("text", x = 500, y = 0.5, label = "Commensal competitor B3",color = "violetred2",
size = 2.8)
show(dynamics_competition_c_section)
library(ggpubr)
dynamics_competition <- ggarrange(dynamics_competition_vaginal, dynamics_competition_c_section,
labels = c("A", "B"), nrow = 1, ncol = 2)
show(dynamics_competition)
ggsave(file = output_dynamics, width = 17, height = 8.5, units = "cm")
# set my theme
mytheme <- theme_bw() +
theme(panel.grid.minor =  element_blank(),
plot.title = element_text(size = 15),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14),
legend.position = "none")
library(tidyr)
# to access break formatting functions
library(scales)
library(ggplot2)
# load data
load("../data generation/data/dynamics_competition_vaginal.rData")
dynamics_competition_vaginal <- ggplot(data = bacteria_melt_vaginal, aes(x = time, y = value,
color = variable)) +
geom_line(size = 0.8, aes(linetype=variable)) +
scale_linetype_manual(values=c("twodash", "solid", "dashed"),
labels=c(expression(B[1]), expression(B[2]),expression(B[3]))) +
scale_color_manual(values = c("skyblue2","seagreen3","violetred2"),
labels=c(expression(B[1]), expression(B[2]),expression(B[3]))) +
scale_y_log10(breaks = trans_breaks("log10", function(x) 10^x),
labels = trans_format("log10", math_format(10^.x)),limits = c(5e-4,1.5)) +
mytheme +
labs( x = "Time (days)", y = "Population density",
title = "Vaginal") +
annotate("text", x = 500, y = 0.005, label = "HMO-consuming Bifidobacteria B1",
color = "skyblue2", size = 2.8) +
annotate("text", x = 500, y = 0.5, label = "Fibre-consuming Bifidobacteria B2",
color = "seagreen3", size = 2.8) +
annotate("text", x = 700, y = 0.03, label = "Commensal competitor B3",color = "violetred2",
size = 2.8)
show(dynamics_competition_vaginal)
# load data
load("../data generation/data/dynamics_competition_c-section.rData")
dynamics_competition_c_section <- ggplot(data = bacteria_melt_csection, aes(x = time, y = value,
color = variable)) +
geom_line(size = 0.8, aes(linetype=variable)) +
scale_linetype_manual(values=c("twodash", "solid","dashed"),
labels=c(expression(B[1]), expression(B[2]),expression(B[3]))) +
scale_color_manual(values = c("skyblue2","seagreen3","violetred2"),
labels=c(expression(B[1]), expression(B[2]),expression(B[3]))) +
scale_y_log10(breaks = trans_breaks("log10", function(x) 10^x),
labels = trans_format("log10", math_format(10^.x)),limits = c(5e-4,1.5)) +
mytheme +
labs( x = "Time (days)", y = "Population density",
title = "Caesarean") +
annotate("text", x = 500, y = 0.005, label = "HMO-consuming Bifidobacteria B1",
color = "skyblue2", size = 2.8) +
annotate("text", x = 500, y = 0.05, label = "Fibre-consuming Bifidobacteria B2",
color = "seagreen3", size = 2.8) +
annotate("text", x = 500, y = 0.5, label = "Commensal competitor B3",color = "violetred2",
size = 2.8)
show(dynamics_competition_c_section)
library(ggpubr)
dynamics_competition <- ggarrange(dynamics_competition_vaginal, dynamics_competition_c_section,
labels = c("A", "B"), nrow = 1, ncol = 2)
show(dynamics_competition)
ggsave(file = output_dynamics, width = 17, height = 8.5, units = "cm")
output_Z <- "plots/z.pdf"
# set my theme
library(ggplot2)
mytheme <- theme_bw() +
theme(panel.grid.minor =  element_blank(),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
legend.text = element_text (size = 12),
legend.title = element_blank())
# competition model
library(tidyr)
# to access break formatting functions
library(scales)
w <- 0.014; h <- 500
t <-  seq(0,1000,1)
Z <- 1/(1 + exp(w*(t - h)))
z.data <- data.frame(Z,t)
library(ggplot2)
z.plot <- ggplot(data = z.data, aes(x = t, y = Z)) +
geom_line(size = 1, color = "steelblue") +
mytheme +
labs( x = "Time (days)", y = "Proportion of milk in diet (Z)")
show(z.plot)
ggsave(file= output_Z, width = 8.5, height = 8.5, units = "cm")
setwd("~/Documents/GitHub/Modelling-the-effect-of-birth-and-feeding-modes-on-the-development-of-human-gut-microbiota/code/data generation")
source('~/Documents/GitHub/Modelling-the-effect-of-birth-and-feeding-modes-on-the-development-of-human-gut-microbiota/code/data generation/effect of milk fz_competition model.R')
# load data
load("../data generation/data/f_z_vaginal_without_M.rdata")
output_fz_competition <- "plots/Bifidobacteria_input_competition_model.pdf"
# library for plot
library(ggplot2)
# The effect of a range of initial conditions in the competition model
library(tidyr)
# to access break formatting functions
library(scales)
# put multiple plots in the same panel
library(ggpubr)
# set my theme
mytheme <- theme_bw() +
theme(panel.grid.minor =  element_blank(),
plot.title = element_text(size = 15),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
axis.title.x = element_text(size = 14),
axis.title.y = element_text(size = 14),
legend.position = "none")
# load data
load("../data generation/data/f_z_vaginal_without_M.rdata")
# make plot
df_long <- gather(df_fz_vaginal,Variables,Values,B_2:B_3,factor_key=TRUE)
f_z_vaginal <-  ggplot(data = df_long, aes(x = f_z, y = Values)) +
geom_line(size = 0.8,aes(linetype=Variables,color=Variables)) +
scale_linetype_manual(values=c("solid","dashed"),
labels=c(expression(B[2]),expression(B[3]))) +
scale_color_manual(values = c("seagreen3","violetred2"),
labels=c(expression(B[2]),expression(B[3]))) +
scale_x_log10(breaks = trans_breaks("log10", function(x) 10^x),
labels = trans_format("log10", math_format(10^.x))) +
scale_y_log10(breaks = trans_breaks("log10", function(x) 10^x),
labels = trans_format("log10", math_format(10^.x))) +
mytheme +
labs( x = bquote("Bifidobacteria in milk, " ~ f[z]), y = "Population at equilibrium",
title = "Vaginal") +
annotate("text", x = 0.001, y = 0.7, label = "Fibre-consuming Bifidobacteria B2",
color = "seagreen3", size = 2.8) +
annotate("text", x = 0.001, y = 0.08, label = "Commensal competitor B3",color = "violetred2",
size = 2.8)
show(f_z_vaginal)
# load data
load("../data generation/data/f_z_c-section_without_M.rdata")
# make plot
df_long <- gather(df_fz_csection,Variables,Values,B_2:B_3,factor_key=TRUE)
f_z_c_section <-  ggplot(data = df_long, aes(x = f_z, y = Values)) +
geom_line(size = 0.8,aes(linetype=Variables,color=Variables)) +
scale_linetype_manual(values=c("solid","dashed"),
labels=c(expression(B[2]),expression(B[3]))) +
scale_color_manual(values = c("seagreen3","violetred2"),
labels=c(expression(B[2]),expression(B[3]))) +
scale_x_log10(breaks = trans_breaks("log10", function(x) 10^x),
labels = trans_format("log10", math_format(10^.x))) +
scale_y_log10(breaks = trans_breaks("log10", function(x) 10^x),
labels = trans_format("log10", math_format(10^.x))) +
mytheme+
labs( x = bquote("Bifidobacteria in milk, " ~ f[z]), y = "Population at equilibrium",
title = "Caesarean") +
annotate("text", x = 0.0006, y = 0.05, label = "Fibre-consuming Bifidobacteria B2",
color = "seagreen3", size = 2.8) +
annotate("text", x = 0.001, y = 0.7, label = "Commensal competitor B3",color = "violetred2",
size = 2.8)
show(f_z_c_section)
# put plots in the same panel
f_z <- ggarrange(f_z_vaginal, f_z_c_section,
labels = c("A", "B"), nrow = 1, ncol = 2)
show(f_z)
ggsave(file = output_fz_competition, width = 17, height = 8.5, units = "cm")
setwd("~/Documents/GitHub/Modelling-the-effect-of-birth-and-feeding-modes-on-the-development-of-human-gut-microbiota/code/plot generation")
ggsave(file = output_fz_competition, width = 17, height = 8.5, units = "cm")
mytheme_z <- theme_bw() +
theme(panel.grid.minor =  element_blank(),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
legend.text = element_text (size = 12),
legend.title = element_blank())
# variable values for Z(t) function
w <- 0.014; h <- 500
t <-  seq(0,1000,1)
Z <- 1/(1 + exp(w*(t - h)))
# make a data frame for plot
z.data <- data.frame(Z,t)
# plot Z(t)
z.plot <- ggplot(data = z.data, aes(x = t, y = Z)) +
geom_line(size = 1, color = "steelblue") +
mytheme_z +
labs( x = "Time (days)", y = "Proportion of milk in diet (Z)")
show(z.plot)
# save the plot
ggsave(file= output_Z, width = 8.5, height = 8.5, units = "cm")
setwd("~/Documents/GitHub/Modelling-the-effect-of-birth-and-feeding-modes-on-the-development-of-human-gut-microbiota/code/data generation")
# run model in parameter space ------------------------------------
source("../model/extended model.R")
source('~/Documents/GitHub/Modelling-the-effect-of-birth-and-feeding-modes-on-the-development-of-human-gut-microbiota/code/data generation/parameter sweep_extended model.R')
# save the data
save(output_pSpace,file = output_heatmap)
# make directory for saving data
output_heatmap <- "data/data_pspace_fz_h.rData"
# save the data
save(output_pSpace,file = output_heatmap)
# load data
load("../data generation/data/data_pspace_fz_h.rData")
output_pSpace$f2 <- factor(output_pSpace$f2, labels=c("f[2]: 0.001", "f[2]: 0.01", "f[2]: 0.02",
"f[2]: 0.03","f[2]: 0.05"))
output_pSpace$f3 <- factor(output_pSpace$f3, labels=c("f[3]: 0.001", "f[3]: 0.01", "f[3]: 0.02",
"f[3]: 0.03","f[3]: 0.05"))
# make plot
ggplot(output_pSpace, aes(f_z, h, fill= Ratio)) + geom_tile()+
facet_grid(f3 ~ f2,labeller = label_parsed) +
scale_fill_gradient(low="yellow", high="blue") +
theme(panel.background = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1,size = 9),
axis.text.y = element_text(size = 10),
axis.title.x = element_text(size = 12),
axis.title.y = element_text(size = 12),
legend.text = element_text (size = 12),
strip.text = element_text(
size = 12, color = "black"),
strip.background = element_rect(fill="white"))  +
labs( x = bquote("Bifidobacteria in milk, " ~ f[z]), y = "Half-life of milk, h (Days)")
ggsave(file = output_heatmap, height = 14,width = 17,units = "cm")
ggsave(file = output_heatmap, height = 14,width = 17,units = "cm")
output_heatmap <- "plots/pSpace_f_z_c-section.pdf"
ggsave(file = output_heatmap, height = 14,width = 17,units = "cm")
setwd("~/Documents/GitHub/Modelling-the-effect-of-birth-and-feeding-modes-on-the-development-of-human-gut-microbiota/code/plot generation")
output_heatmap <- "plots/pSpace_f_z_c-section.pdf"
ggsave(file = output_heatmap, height = 14,width = 17,units = "cm")
